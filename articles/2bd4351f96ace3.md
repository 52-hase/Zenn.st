---
title: "Active Storageã®ç”»åƒã‚’AWSã®S3ã¸ä¿å­˜ã™ã‚‹"
emoji: "ğŸ–¼ï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [ActiveStorage, AWS, S3]
published: false
---
### é–‹ç™ºç’°å¢ƒ
- macOS
- VSCode
- Rails 7.1.3.3
- ruby-3.2.3
- PostgreSQL 16.2

### è¡Œã„ãŸã„ã“ã¨
- Herokuã®ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒã§ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¯`æ®ç™ºæ€§ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸`ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ãã®ãŸã‚ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å†èµ·å‹•æ™‚ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®å¤‰æ›´ãŒå¤±ã‚ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚
ä»Šå›ã¯ç”»åƒã®ãƒ‡ãƒ¼ã‚¿ã‚’æ°¸ç¶šçš„ã«ä¿å­˜ã™ã‚‹ãŸã‚ã«ã€`AWS`ã®`S3`ã‚’å°å…¥ã—ãŸã®ã§ãã®æµã‚Œã‚’è¨˜è¼‰ã—ã¾ã™ã€‚

### å‰æã¨ã—ã¦
- æ—¢ã«Active Storageã®ç”»åƒã‚’æ­£ã—ãä¿å­˜ã§ãã¦ã„ã‚‹
- AWSã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ä½œæˆæ¸ˆã¿
- Herokuã«ã¯ãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿


# AWSã®S3ã§ãƒã‚±ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹

##### ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’`æ±äº¬`ã«å¤‰æ›´ã™ã‚‹ã€‚ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯`ãƒãƒ¼ã‚¸ãƒ‹ã‚¢åŒ—éƒ¨`ã¨ãªã£ã¦ã„ã‚‹ï¼‰
::::details å‚è€ƒç”»åƒ
[![Image from Gyazo](https://i.gyazo.com/903dba2e4bb9d7a85f75973dec9b6ab9.png)](https://gyazo.com/903dba2e4bb9d7a85f75973dec9b6ab9)
::::

##### æ¤œç´¢æ¬„ã«`S3`ã¨å…¥åŠ›ã—`S3`ã‚’é¸æŠã™ã‚‹ã€‚
::::details å‚è€ƒç”»åƒ
[![Image from Gyazo](https://i.gyazo.com/9268e288928375881727816b2eb56949.png)](https://gyazo.com/9268e288928375881727816b2eb56949)
::::

##### ãƒã‚±ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹ã€‚
::::details å‚è€ƒç”»åƒ
[![Image from Gyazo](https://i.gyazo.com/35166ce7b979b1fdd606581eac34037b.png)](https://gyazo.com/35166ce7b979b1fdd606581eac34037b)
::::

##### ãƒã‚±ãƒƒãƒˆã®ä¸€èˆ¬çš„ãªè¨­å®šï¼ˆã“ã®è¨­å®šä»¥å¤–ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
::::details ãƒã‚±ãƒƒãƒˆåã®è¨˜è¼‰
ãƒ»ä»»æ„ã®ãƒã‚±ãƒƒãƒˆåã‚’è¨˜è¼‰ã™ã‚‹ã€‚
[![Image from Gyazo](https://i.gyazo.com/62510113652b4be7facea27902ca4ca2.png)](https://gyazo.com/62510113652b4be7facea27902ca4ca2)
::::

::::details ãƒã‚±ãƒƒãƒˆã®ãƒ–ãƒ­ãƒƒã‚¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹è¨­å®š
ãƒ»`ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚’ã™ã¹ã¦ãƒ–ãƒ­ãƒƒã‚¯`ã®ãƒã‚§ãƒƒã‚¯ã‚’å¤–ã™ã€‚
ãƒ»ç”»åƒã®ã‚ˆã†ã«ä¸‹ã®ï¼’ã¤ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹ã€‚ â‡¨ è¡¨ç¤ºã•ã‚Œã‚‹`æ‰¿èªã—ã¾ã™`ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹ã€‚
ãƒ»`ãƒã‚±ãƒƒãƒˆã‚’ä½œæˆ`ã‚’é¸æŠ
[![Image from Gyazo](https://i.gyazo.com/bb74ab2ccd097e8653696ad2feb77158.png)](https://gyazo.com/bb74ab2ccd097e8653696ad2feb77158)
::::

# IAMãƒãƒªã‚·ãƒ¼ã®ä½œæˆ
##### æ¤œç´¢æ¬„ã§`IAM`ã¨å…¥åŠ›ã—`IAM`ã‚’é¸æŠã™ã‚‹ã€‚ â‡¨ `ãƒãƒªã‚·ãƒ¼`ã‚’é¸æŠã™ã‚‹ã€‚ â‡¨ `ãƒãƒªã‚·ãƒ¼`ã®ä½œæˆ 
::::details å‚è€ƒç”»åƒ
ãƒ»`IAM`ã‚’é¸æŠ
[![Image from Gyazo](https://i.gyazo.com/8764d8807374f310c2871f83a6ebe8a2.png)](https://gyazo.com/8764d8807374f310c2871f83a6ebe8a2)
ãƒ»ãƒãƒªã‚·ãƒ¼ã‚’é¸æŠ
[![Image from Gyazo](https://i.gyazo.com/63dc3eebd839ce34f58571d19cfebfe5.png)](https://gyazo.com/63dc3eebd839ce34f58571d19cfebfe5)
ãƒ»ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ
[![Image from Gyazo](https://i.gyazo.com/febc5aa717c86877afd72723f66a8202.png)](https://gyazo.com/febc5aa717c86877afd72723f66a8202)
::::

##### ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã‚’æŒ‡å®š 
::::details ã‚µãƒ¼ãƒ“ã‚¹ã‚’é¸æŠã§S3ã‚’é¸æŠ
ãƒ»`S3`ã‚’é¸æŠ â‡¨ æ¬¡ã¸
[![Image from Gyazo](https://i.gyazo.com/5e4e0da01d4acfa03fd7848f3e8b5137.png)](https://gyazo.com/5e4e0da01d4acfa03fd7848f3e8b5137)
::::

::::details ãƒªã‚¹ãƒˆã€èª­ã¿å–ã‚Šã€æ›¸ãè¾¼ã¿ã€è¨±å¯ã®ç®¡ç†ã€ã‚¿ã‚°ä»˜ã‘ã‚’ãã‚Œãã‚Œé¸æŠã™ã‚‹
ãƒ»`S3`ã‚¿ãƒ–ã‚’å±•é–‹
[![Image from Gyazo](https://i.gyazo.com/240866e04a79a0f7808f08a6dd17d016.png =400x)](https://gyazo.com/240866e04a79a0f7808f08a6dd17d016)

ãƒ»ãƒªã‚¹ãƒˆ â‡¨ `ListBucket`
[![Image from Gyazo](https://i.gyazo.com/f740a5c9da323791081058f83808b88c.png)](https://gyazo.com/f740a5c9da323791081058f83808b88c)
ãƒ»èª­ã¿å–ã‚Š â‡¨ `GetObject`
[![Image from Gyazo](https://i.gyazo.com/9666c63fd34673eb74d6348afabeb0cd.png)](https://gyazo.com/9666c63fd34673eb74d6348afabeb0cd)
ãƒ»æ›¸ãè¾¼ã¿ â‡¨ `DeleteObject`ã¨`PutObject`
[![Image from Gyazo](https://i.gyazo.com/72c380078a68018d0dd6aa0dec1ec715.png)](https://gyazo.com/72c380078a68018d0dd6aa0dec1ec715)
ãƒ»è¨±å¯ã®ç®¡ç† â‡¨ `PutObjectAcl`
[![Image from Gyazo](https://i.gyazo.com/9a9fb37c4800c3d6af2dc5d8964fe744.png)](https://gyazo.com/9a9fb37c4800c3d6af2dc5d8964fe744)
::::

::::details ARNã‚’è¿½åŠ ã‚’ã™ã‚‹
ãƒ»bucketã®ã¿`ARNã‚’è¿½åŠ `ã‚’é¸æŠã—è¨˜è¼‰
[![Image from Gyazo](https://i.gyazo.com/7ae04ecde20e8cb78ff4b316d6159829.png)](https://gyazo.com/7ae04ecde20e8cb78ff4b316d6159829)
ãƒ»ãƒªã‚½ãƒ¼ã‚¹ãƒã‚±ãƒƒãƒˆåã«ä½œæˆã—ãŸãƒã‚±ãƒƒãƒˆåã‚’è¨˜è¼‰ã™ã‚‹ï¼ˆãƒªã‚½ãƒ¼ã‚¹ARNã¯è‡ªå‹•ã§è¨˜è¼‰ã•ã‚Œã‚‹ï¼‰â‡¨ `ARNã‚’è¿½åŠ ` â‡¨ æ¬¡ã¸
[![Image from Gyazo](https://i.gyazo.com/5f045cde47b7a72b3a7d479c5e4b544f.png)](https://gyazo.com/5f045cde47b7a72b3a7d479c5e4b544f)
::::

##### ãƒãƒªã‚·ãƒ¼ã®è©³ç´°
::::details ãƒãƒªã‚·ãƒ¼åã‚’è¨˜è¼‰
ãƒ»ãƒãƒªã‚·ãƒ¼åã®ã¿è¨˜è¼‰ï¼ˆèª¬æ˜-ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ä¸è¦ï¼‰
[![Image from Gyazo](https://i.gyazo.com/5dce4f24180631d31715f89ef4a90bd6.png)](https://gyazo.com/5dce4f24180631d31715f89ef4a90bd6)
ãƒ»ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ
[![Image from Gyazo](https://i.gyazo.com/7fc7aa9a0c8677eab158bc1d0411cef7.png)](https://gyazo.com/7fc7aa9a0c8677eab158bc1d0411cef7)
::::

# IAMãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆ

::::details 
[![Image from Gyazo](https://i.gyazo.com/7c266df10c6d5fbf428e66415adde700.png)](https://gyazo.com/7c266df10c6d5fbf428e66415adde700)
::::

::::details 

'''


'''

::::

::::details 

'''


'''

::::

::::details 

'''


'''

::::

::::details 

'''


'''

::::


::::details 

'''


'''

::::

::::details 

'''


'''

::::



::::details 

'''


'''

::::

::::details 

'''


'''

::::



::::details 

'''


'''

::::

::::details 

'''


'''

::::