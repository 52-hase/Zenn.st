---
title: "Dockerについての基礎学習"
emoji: "📚"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [Docker]
published: false
---
### 開発環境
- macOS
- VSCode
- Rails 7.1.3.3
- ruby-3.2.3
- PostgreSQL 16.2
- Heroku

### 行いたいこと
- Dockerの基本概念から応用技術まで全体像を理解する


<br>
<br>
<br>




Dockerの基本概念から応用まで全体像を整理し、仕組みを理解するための記事
前編では「コンテナ、イメージ、DockerHubでのイメージ共有」について解説

Dockerとは

Docker社が提供するコンテナ型仮想化技術を実現するプロダクト
従来のホスト型仮想化と異なり、ゲストOSを起動せずにDocker Engine上でコンテナを動作
従来の仮想化より圧倒的に軽量

Dockerのメリット

複数開発者間でのアプリケーション実行環境の共有が容易
軽量な動作と環境ファイル共有を実現
複雑なアーキテクチャでも簡単にどんなマシンにも共有可能

Docker Engineの要素
⓪ Docker Engine

Dockerを利用するための常駐プログラム
Docker for Mac、Docker for Windows等をインストールして利用

① イメージ（Image）

コンテナを起動するのに必要な設定ファイルをまとめたもの
imageからコンテナを起動する
tagでバージョン管理（例：nginx:latest、nginx:1.14-perl）
レイヤー構造で、読み取り専用

② コンテナ

imageから起動されるアプリケーションの実行環境
主要なコマンド操作（create、start、stop、restart、pause、unpause、rm等）
コンテナへの接続方法（attach、exec）

③ Docker Hub（Container Registry）

Dockerイメージを共有するためのサービス
Githubと同様の仕組みで、リポジトリ作成、push、pullが可能
アカウント作成とログインが必要

イメージの作成方法

Docker Hubから他人が作ったイメージを取得（docker pull）
Dockerfileから自作（FROM、RUN、CMDコマンドを使用）
コンテナからイメージを作成（docker commit）※推奨されない

この4つの要素（Docker Engine、Image、コンテナ、Container Registry）が連携してDockerエコシステムを構成しています。


記事の目的

中編では「データマウント（volume）、Docker Network、Docker Compose」について解説
複数コンテナの管理と連携に関する概念を整理

④ Dockerにおけるデータ管理
コンテナレイヤーのデメリット

コンテナ削除時にデータが消える
コンテナ間でデータ共有ができない
ユニオンファイルシステムのため書き込み速度が遅い

データマウント手法（3種類）
volume

ホストマシン上の指定ディレクトリ（/var/lib/docker/volumes）をコンテナにマウント
docker volume createでvolume作成
--mountオプションでマウント
複数コンテナ間でのファイル共有が可能
コンテナごとに編集権限の設定が可能
管理コマンド：ls、inspect、rm

bind mount

ホストマシン上の任意のディレクトリをマウント
ホスト側から直接操作可能
事前設定不要、起動時にオプション指定
マウント元ディレクトリが存在しない場合はエラー
空ディレクトリをマウントするとコンテナデータが消える可能性

tmpfs（テンプfs）

ホストマシンのメモリ領域をコンテナにマウント
ホストやコンテナ終了時にデータが解放される
メモリサイズ制限のオプション設定可能

⑤ Dockerネットワーク
ネットワークの目的

複数コンテナ間での通信を実現
例：APIサーバコンテナとMySQLコンテナの通信

デフォルトネットワーク（3種類）
Bridgeネットワーク

コンテナのデフォルト接続先
IPアドレス指定での通信は可能
コンテナ名での通信は不可（DNS未定義）
-pオプションで外部ポート公開

Hostネットワーク

Docker hostと同じネットワーク設定
ポート公開設定不要で外部アクセス可能

Noneネットワーク

ネットワークインターフェースが無効
他のネットワークから完全切断が必要

独自ネットワーク

docker network createで作成
コンテナ名での通信が可能（組み込みDNS機能）
管理コマンド：ls、inspect、create、connect、disconnect

⑥ Docker Compose
Docker Composeの目的

複数コンテナのDockerアプリケーションを事前定義して実行
複雑なオプション付きコマンドの自動化
環境共有の円滑化

基本的な使用手順

Dockerfileの用意またはDocker Hubのイメージ準備
docker-compose.ymlの定義
docker-compose upでコンテナ群を起動

Docker Compose使用時の利点

単一のymlファイルで複数コンテナの設定を管理
一つのコマンドで複数コンテナを起動・設定
設定ファイル共有による環境の標準化

主要管理コマンド

docker-compose ps：コンテナ一覧表示
docker-compose up：コンテナ起動
docker-compose down：コンテナ・ネットワーク削除
docker-compose run：指定サービス内でコマンド実行
docker-compose stop/start：コンテナ停止・起動

実装例（Django Webアプリ）

Dockerfile：Python環境とDjangoの設定
docker-compose.yml：webサーバとdbサーバの定義
depends_on：コンテナ起動順序の制御
volumes、portsの設定による環境構築


<br>
<br>


### 以上です。

<br>
<br>
<br>