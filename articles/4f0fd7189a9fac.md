---
title: "é™çš„OGPã®è¨­å®šæ–¹æ³•ï¼ˆé–‹ç™ºç’°å¢ƒ / æœ¬ç•ªç’°å¢ƒï¼‰"
emoji: "ğŸ“˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [OGP, LocalhostOpenGraphDebugger]
published: true
---
### é–‹ç™ºç’°å¢ƒ
- macOS
- VSCode
- Rails 7.1.3.3
- ruby-3.2.3
- PostgreSQL 16.2

### è¡Œã„ãŸã„ã“ã¨
- `Xï¼ˆTwitterï¼‰`ã§é–‹ç™ºã—ãŸã‚¢ãƒ—ãƒªã®ãƒªãƒ³ã‚¯ã‚’ãƒã‚¹ãƒˆã™ã‚‹éš›ã«`é™çš„OGP`ã§æŒ‡å®šã—ãŸç”»åƒã‚„ã‚¿ã‚¤ãƒˆãƒ«ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ï¼ˆé–‹ç™ºç’°å¢ƒ / æœ¬ç•ªç’°å¢ƒï¼‰
<br>
<br>
<br>

# Gemã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
ãƒ»`Gemfile`ã«ä»¥ä¸‹ã‚’è¿½è¨˜ã—`bundle install`
```js:Gemfile
gem "meta-tags"
```
# rails g meta_tags:install ã‚³ãƒãƒ³ãƒ‰ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ 
ãƒ»ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ
```js:ã‚¿ãƒ¼ãƒŸãƒŠãƒ«
$ rails g meta_tags:install
```
ãƒ»ã“ã¡ã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¿½åŠ ã•ã‚Œã‚‹ï¼ˆä¿®æ­£è¿½è¨˜ä¸è¦ï¼‰
```js:config/initializers/meta_tags.rb
MetaTags.configure do |config|

# ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã§æ§˜ã€…ãªè¨˜è¼‰

end
```

# display_meta_tagsãƒ¡ã‚½ãƒƒãƒ‰ã®è¿½è¨˜
ãƒ»`app/views/layouts/application.html.erb`ã«ä»¥ä¸‹ã®è¿½è¨˜ã‚’ã™ã‚‹
```rb:app/views/layouts/application.html.erb
<!DOCTYPE html>
<html>
  <head>
    <title>Myapp</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "application", media: "all", as: "style", "data-turbo-track": "reload" %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload", type: "module" %>

    <%= display_meta_tags(default_meta_tags) %>   # ã“ã‚Œã‚’è¿½è¨˜
```

# default_meta_tags ãƒ¡ã‚½ãƒƒãƒ‰ã®è¨˜è¼‰
ãƒ»`app/helpers/application_helper.rb`ã«ä»¥ä¸‹ã®æ§˜ã«è¨˜è¼‰
```rb:app/helpers/application_helper.rb
module ApplicationHelper
  def default_meta_tags
    {
      site: 'Live Fes',
      title: 'éŸ³æ¥½ãƒ©ã‚¤ãƒ–ãƒ»ãƒ•ã‚§ã‚¹ã®ä½™éŸ»ã‚’å…±æœ‰ã§ãã‚‹ã‚µãƒ¼ãƒ“ã‚¹',
      reverse: true,
      charset: 'utf-8',
      description: 'Live Fesã§ã¯ã€éŸ³æ¥½ãƒ©ã‚¤ãƒ–ã‚„ãƒ•ã‚§ã‚¹ã®ä½™éŸ»ã‚„å–ªå¤±æ„Ÿã‚’å‚åŠ è€…åŒå£«ã§å…±é€šã—ã€æ„Ÿæƒ³ã‚„æ€ã„å‡ºã‚’èªã‚Šåˆã†ã“ã¨ãŒã§ãã¾ã™ã€‚',
      keywords: 'éŸ³æ¥½,ãƒ©ã‚¤ãƒ–,ãƒ•ã‚§ã‚¹,ä½™éŸ»,å–ªå¤±æ„Ÿ,å…±æœ‰',
      canonical: request.original_url,
      separator: '|',
      og:{
        site_name: :site,
        title: :title,
        description: :description,
        type: 'website',
        url: request.original_url,
        image: image_url('ogp.png'),
        local: 'ja-JP'
      },
      twitter: {
        card: 'summary_large_image',
        site: '@obvyamdrss',
        image: image_url('ogp.png')
      }
    }
  end
end
```

# app/assets/images/ogp.png ã«è¡¨ç¤ºã—ãŸã„ç”»åƒã‚’é…ç½®
ãƒ»`default_meta_tags ãƒ¡ã‚½ãƒƒãƒ‰`ã«`image: image_url('ogp.png')`ã¨è¨˜è¼‰ã—ãŸå ´åˆã¯ã€
ã€€`app/assets/images/ogp.png`ã«ç”»åƒã‚’é…ç½®ã™ã‚‹
ãƒ»è¡¨ç¤ºã—ãŸã„ã‚µã‚¤ã‚ºãŒã‚ã‚Œã°èª¿æ•´ã—ã¦ã‹ã‚‰é…ç½®ã™ã‚‹
[![Image from Gyazo](https://i.gyazo.com/8cf110b049d4f95993bc0af64a1ef627.png)](https://gyazo.com/8cf110b049d4f95993bc0af64a1ef627)


# OGPã‚’é–‹ç™ºç’°å¢ƒã§ç¢ºèªã™ã‚‹
ãƒ»Chromeã®æ‹¡å¼µæ©Ÿèƒ½`Localhost Open Graph Debugger`ã‚’ä½¿ã„ç”»åƒã‚„ã‚¿ã‚¤ãƒˆãƒ«ãŒ
ã€€è¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèªã™ã‚‹ï¼ˆä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‹ã‚‰æ‹¡å¼µæ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã™ï¼‰

https://chrome.google.com/webstore/detail/localhost-open-graph-debu/kckjjmiilgndeaohcljonedmledlnkij

ãƒ»æ‹¡å¼µæ©Ÿèƒ½ã‚’è¿½åŠ ã—ãŸã‚‰é–‹ç™ºç’°å¢ƒã§ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‹ãã€€ã€€ã€€ã€€ã€€ã€€ â‡©ã“ã“ã«æ‹¡å¼µæ©Ÿèƒ½ãŒè¡¨ç¤ºã•ã‚Œã‚‹
[![Image from Gyazo](https://i.gyazo.com/f66d7d9a10f9863d0fb01bb9f57823ff.png)](https://gyazo.com/f66d7d9a10f9863d0fb01bb9f57823ff)

ãƒ»æ‹¡å¼µæ©Ÿèƒ½ã‚’é¸æŠã™ã‚‹ã¨ä»¥ä¸‹ã®æ§˜ã«è¡¨ç¤ºã•ã‚Œã‚‹ã®ã§`Submit`ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹
 â‡¨`Success`ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã¨åˆ¥ãƒ–ãƒ©ã‚¦ã‚¶ã«`Copy Link`ãŒè¡¨ç¤ºã•ã‚Œã‚‹
[![Image from Gyazo](https://i.gyazo.com/8fd55e6bdb09ae5b1b812c444d241964.png =400x)](https://gyazo.com/8fd55e6bdb09ae5b1b812c444d241964)
ãƒ»è¡¨ç¤ºã•ã‚ŒãŸ`Copy  Link`ã‚’ã‚³ãƒ”ãƒ¼â‡¨`and debug it on`ã‹ã‚‰`X`ã‚’é¸æŠ
[![Image from Gyazo](https://i.gyazo.com/c1ad4f9fa8a14f05fcaf14943f6278a6.png)](https://gyazo.com/c1ad4f9fa8a14f05fcaf14943f6278a6)
ãƒ»`Card URL`ã«ã‚³ãƒ”ãƒ¼ã—ãŸURLã‚’è²¼ã‚Šä»˜ã‘ã‚‹â‡¨`Preview Card`ã‚’ã‚¯ãƒªãƒƒã‚¯
ãƒ»ä»¥ä¸‹ã®æ§˜ã«logã«`Card loaded successfully`ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã¾ã™
[![Image from Gyazo](https://i.gyazo.com/7146278c575e44963155f9dc07266ad5.png)](https://gyazo.com/7146278c575e44963155f9dc07266ad5)ãƒ»ç™ºè¡Œã•ã‚ŒãŸURLã‚’`notion`ã«è²¼ã‚Šä»˜ã‘ä»¥ä¸‹ã®æ§˜ã«è¡¨ç¤ºã•ã‚Œã‚Œã°æ­£ã—ãè¨­å®šã§ãã¦ã„ã¾ã™
[![Image from Gyazo](https://i.gyazo.com/fa25246efbb5946e10ed854fe4094a66.png =800x)](https://gyazo.com/fa25246efbb5946e10ed854fe4094a66)

# OGPã‚’æœ¬ç•ªç’°å¢ƒã«è¨­å®šã™ã‚‹
ãƒ»`canonical:`ã¨`url:`ã‚’æœ¬ç•ªãƒ–ãƒ©ã‚¦ã‚¶ã®URLã«ä¿®æ­£ã™ã‚‹
ãƒ»æœ¬ç•ªç’°å¢ƒã‚‚é–‹ç™ºç’°å¢ƒã¨åŒæ§˜ã«`Localhost Open Graph Debugger`ã€`notion`ã«è²¼ã‚Šä»˜ã‘ã‚‹ã“ã¨ã§
ã€€`OGP`ã‚’ç¢ºèªã§ãã¾ã™
```rb:app/views/layouts/application.html.erb
module ApplicationHelper
  def default_meta_tags
    {
      site: 'Live Fes',
      title: 'éŸ³æ¥½ãƒ©ã‚¤ãƒ–ãƒ»ãƒ•ã‚§ã‚¹ã®ä½™éŸ»ã‚’å…±æœ‰ã§ãã‚‹ã‚µãƒ¼ãƒ“ã‚¹',
      reverse: true,
      charset: 'utf-8',
      description: 'Live Fesã§ã¯ã€éŸ³æ¥½ãƒ©ã‚¤ãƒ–ã‚„ãƒ•ã‚§ã‚¹ã®ä½™éŸ»ã‚„å–ªå¤±æ„Ÿã‚’å‚åŠ è€…åŒå£«ã§å…±é€šã—ã€æ„Ÿæƒ³ã‚„æ€ã„å‡ºã‚’èªã‚Šåˆã†ã“ã¨ãŒã§ãã¾ã™ã€‚',
      keywords: 'éŸ³æ¥½,ãƒ©ã‚¤ãƒ–,ãƒ•ã‚§ã‚¹,ä½™éŸ»,å–ªå¤±æ„Ÿ,å…±æœ‰',
      canonical: æœ¬ç•ªç’°å¢ƒã®ãƒ–ãƒ©ã‚¦ã‚¶ã®URL,ã€€ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ï¼ˆä¿®æ­£ï¼‰
      separator: '|',
      og:{
        site_name: :site,
        title: :title,
        description: :description,
        type: 'website',
        url: æœ¬ç•ªç’°å¢ƒã®ãƒ–ãƒ©ã‚¦ã‚¶ã®URL,ã€€ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ï¼ˆä¿®æ­£ï¼‰
        image: image_url('ogp.png'),
        local: 'ja-JP'
      },
      twitter: {
        card: 'summary_large_image',
        site: '@obvyamdrss',
        image: image_url('ogp.png')
      }
    }
  end
end
```

### ä»¥ä¸Šã§é™çš„OGPã®è¨­å®šã¯å®Œäº†ã§ã™ã€‚